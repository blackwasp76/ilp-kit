# Virtual Hosts
#
# Required modules: mod_log_config

# If you want to maintain multiple domains/hostnames on your
# machine you can setup VirtualHost containers for them. Most configurations
# use only name-based virtual hosts so the server doesn't need to worry about
# IP addresses. This is indicated by the asterisks in the directives below.
#
# Please see the documentation at 
# <URL:http://httpd.apache.org/docs/2.4/vhosts/>
# for further details before you try to setup virtual hosts.
#
# You may use the command line option '-S' to verify your virtual host
# configuration.

#
# VirtualHost example:
# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for all requests that do not
# match a ServerName or ServerAlias in any <VirtualHost> block.
#

#<VirtualHost *:80>
#  ServerName wallet1.example
#
#  RewriteEngine On
#  RewriteCond %{HTTP:Connection} Upgrade [NC]
#  RewriteRule /(.*) ws://wallet1.example:3010/$1 [P,L]
#
#  ProxyRequests Off
#  ProxyPass /ledger/websocket ws://localhost:3101/websocket
#
#  ProxyPass / http://wallet1.example:3010/ retry=0
#  ProxyPassReverse / http://wallet1.example:3010/
#</VirtualHost>
#
#<VirtualHost *:443>
#  ServerName wallet1.example
#  ProxyPass / http://wallet1.example:3010/ retry=0
#  ProxyPassReverse / http://wallet1.example:3010/
#  RedirectMatch ^/$ https://wallet1.example
#
#  ProxyRequests Off
#  ProxyPass /ledger/websocket ws://localhost:3101/websocket
#
#  SSLEngine on
#  SSLCertificateFile /etc/apache2/ssl/wallet1.example.crt
#  SSLCertificateKeyFile /etc/apache2/ssl/wallet1.example.key
#</VirtualHost>

<VirtualHost *:443>
  ServerName wallet1.example

  RewriteEngine On
  RewriteCond %{HTTP:Connection} Upgrade [NC]
  RewriteRule /(.*) ws://wallet1.example:3010/$1 [P,L]

  ProxyRequests Off
  ProxyPass /ledger/websocket ws://localhost:3101/websocket

  ProxyPass / http://wallet1.example:3010/ retry=0
  ProxyPassReverse / http://wallet1.example:3010/

  SSLEngine on
  SSLCertificateFile /etc/apache2/ssl/wallet1.example.crt
  SSLCertificateKeyFile /etc/apache2/ssl/wallet1.example.key
</VirtualHost>

<VirtualHost *:443>
  ServerName wallet2.example

  RewriteEngine On
  RewriteCond %{HTTP:Connection} Upgrade [NC]
  RewriteRule /(.*) ws://wallet2.example:3110/$1 [P,L]

  ProxyRequests Off
  ProxyPass /ledger/websocket ws://localhost:3101/websocket

  ProxyPass / http://wallet2.example:3110/ retry=0
  ProxyPassReverse / http://wallet2.example:3110/

  SSLEngine on
  SSLCertificateFile /etc/apache2/ssl/wallet2.example.crt
  SSLCertificateKeyFile /etc/apache2/ssl/wallet2.example.key
</VirtualHost>

<VirtualHost *:443>
  ServerName wallet3.example

  RewriteEngine On
  RewriteCond %{HTTP:Connection} Upgrade [NC]
  RewriteRule /(.*) ws://wallet3.example:3210/$1 [P,L]

  ProxyRequests Off
  ProxyPass /ledger/websocket ws://localhost:3101/websocket

  ProxyPass / http://wallet3.example:3210/ retry=0
  ProxyPassReverse / http://wallet3.example:3210/

  SSLEngine on
  SSLCertificateFile /etc/apache2/ssl/wallet3.example.crt
  SSLCertificateKeyFile /etc/apache2/ssl/wallet3.example.key
</VirtualHost>
